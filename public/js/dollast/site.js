// Generated by LiveScript 1.3.1
var app;
app = angular.module('dollast-site-app', ["dollast-crud", "angular-jwt"]);
app.controller('navbar-ctrl', [
  "$scope", "jwtHelper", function($scope, jwtHelper){
    $scope.loadToken = function(){
      var token, payload, e;
      token = localStorage.token;
      if (!token) {
        return;
      }
      try {
        payload = jwtHelper.decodeToken(token);
        console.log(payload);
        return $scope.uid = payload._id;
      } catch (e$) {
        e = e$;
        return console.log(e);
      }
    };
    $scope.logout = function(){
      var ref$;
      delete localStorage.token;
      return ref$ = $scope.uid, delete $scope.uid, ref$;
    };
    return $scope.loadToken();
  }
]);
app.controller('index-ctrl', ["$scope", "site-serv", "$location", function($scope, siteServ, $location){}]);
app.controller('login-ctrl', [
  "$scope", "site-serv", function($scope, siteServ){
    return $scope.submit = function(user){
      return siteServ.login($scope.user, function(it){
        console.log(it);
        $scope.msg = it.status !== "OK";
        siteServ.token = it.token;
        return localStorage.token = it.token;
      });
    };
  }
]);
app.controller('msg-center-ctrl', [
  "$scope", "$timeout", "msgCenter", function($scope, $timeout, msgCenter){
    $scope.shared = {
      messages: [],
      type: ""
    };
    console.log(msgCenter);
    $timeout(function(){
      return msgCenter.load($scope.shared);
    });
    $scope.flip = function(dir){
      msgCenter.shape(dir);
    };
    return $scope.style = function(type){
      switch (type) {
      case "ok":
        return "green";
      case "err":
        return "red";
      default:
        throw Error('unimplemented');
      }
    };
  }
]);