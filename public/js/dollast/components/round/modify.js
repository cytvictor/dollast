// Generated by LiveScript 1.3.1
(function(){
  var createClass, ref$, labelField, iconText, iconInput, connect, I, onGetRound, onAddProbToRound, log, selector;
  createClass = require('react').createClass;
  ref$ = require('../elements'), labelField = ref$.labelField, iconText = ref$.iconText, iconInput = ref$.iconInput;
  connect = require('react-redux').connect;
  I = require('immutable');
  ref$ = require('../../actions'), onGetRound = ref$.onGetRound, onAddProbToRound = ref$.onAddProbToRound;
  log = debug('dollast:component:round:modify');
  selector = function(state){
    return {
      round: state.getIn(['round', 'update'], I.Map({
        probs: []
      }))
    };
  };
  module.exports = connect(selector)(createClass({
    displayName: 'rnd-modify',
    componentWillMount: function(){
      if (this.props.params.rid) {
        return this.props.dispatch(onGetRound(this.props.params.rid, 'update', 'total'));
      }
    },
    insertProb: function(pid){
      pid = parseInt(pid);
      if (Number.isInteger(pid)) {
        return this.props.dispatch(onAddProbToRound(pid));
      }
    },
    handleInput: function(evt){
      if (evt.which === 13) {
        this.insertProb(evt.target.value);
        return evt.target.value = '';
      }
    },
    onAddProb: function(){
      var $input;
      $input = $('#pid');
      return this.insertProb($input[0].value);
    },
    render: function(){
      var round, prob;
      round = this.props.round.toJS();
      return _('div', {
        className: "ui form segment"
      }, _('h1', {
        className: "ui header dividing"
      }, "Round"), _('div', {
        className: "ui fields three"
      }, _(labelField, {
        text: 'title'
      }, _('div', {
        className: "ui input"
      }, _('input', {
        name: 'title'
      }))), _(labelField, {
        text: "start from"
      }, _('div', {
        className: "ui input"
      }, _('input', {
        name: 'begTime'
      }))), _(labelField, {
        text: "end at"
      }, _('div', {
        className: "ui input"
      }, _('input', {
        name: 'endTime'
      })))), _('h2', {
        className: "ui header dividing"
      }, 'problemset'), _('div', {
        className: "ui two fields"
      }, _('div', {
        className: "field"
      }, _('table', {
        className: "ui table segment definition"
      }, _('thead', null, _('tr', null, _('th', {
        className: 'collapsing'
      }, ""), _('th', null, 'pid'))), _('tbody', null, (function(){
        var i$, ref$, len$, results$ = [];
        for (i$ = 0, len$ = (ref$ = round.probs).length; i$ < len$; ++i$) {
          prob = ref$[i$];
          results$.push(_('tr', {
            key: prob
          }, _('td', null, _('div', {
            className: "ui icon button"
          }, _('i', {
            className: "icon mini remove"
          }))), _('td', null, prob._id + ". " + prob.outlook.title)));
        }
        return results$;
      }())), _('tfoot', null, _('tr', null, _('th', null, ""), _('th', null, _('div', {
        className: "ui input action"
      }, _('input', {
        name: 'pid',
        id: 'pid',
        onChange: this.handleInput
      }), _(iconText, {
        className: "floated right",
        icon: "chevron right",
        text: 'add',
        onClick: this.onAddProb
      })))))))), _('div', {
        className: 'field'
      }, _(iconText, {
        className: "floated right red",
        text: 'delete',
        icon: 'delete',
        onClick: this['delete']
      }), _(iconText, {
        className: "floated right secondary",
        text: 'cancel',
        icon: 'cancel'
      }), _(iconText, {
        className: "floated right primary",
        text: 'save',
        icon: 'save',
        onClick: this.submit
      })));
    }
  }));
}).call(this);
