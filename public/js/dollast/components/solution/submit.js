// Generated by LiveScript 1.4.0
(function(){
  var createClass, connect, onSubmitSolution, ref$, field, labelField, dropdown, iconText, I, log, selector;
  createClass = require('react/addons').createClass;
  connect = require('react-redux').connect;
  onSubmitSolution = require('../../actions').onSubmitSolution;
  ref$ = require('../elements'), field = ref$.field, labelField = ref$.labelField, dropdown = ref$.dropdown, iconText = ref$.iconText;
  I = require('immutable');
  log = debug('dollast:component:solution:submit');
  selector = function(state){
    return {
      uid: state.getIn(['session', 'uid'], "guest")
    };
  };
  module.exports = connect(selector)(createClass({
    displayName: 'sol-submit',
    componentDidMount: function(){
      var $form;
      $form = $('#solution-submit');
      return $form.form({
        on: 'blur',
        fields: {
          code: {
            identifier: 'code',
            rules: [
              {
                type: 'minLength[4]',
                prompt: 'code minimum length is 4'
              }, {
                type: 'maxLength[65535]',
                prompt: 'code length cannot exceed 65535'
              }
            ]
          },
          lang: {
            identifier: 'lang',
            rules: [{
              type: 'empty',
              prompt: 'language cannot be empty'
            }]
          }
        },
        onSuccess: this.submit
      });
    },
    submit: function(e){
      var $form, allValues, data;
      e.preventDefault();
      $form = $('#solution-submit');
      allValues = $form.form('get values');
      data = importAll$(allValues, {
        pid: this.props.params.pid,
        uid: this.props.uid
      });
      return this.props.dispatch(onSubmitSolution(data));
    },
    render: function(){
      return _div({
        className: "ui form segment relaxed",
        id: 'solution-submit'
      }, _(field, null, _h1({
        className: "header divided"
      }, "problem: " + this.props.params.pid)), _div({
        className: "ui error message"
      }), _(labelField, {
        text: 'code'
      }, _textarea({
        name: 'code'
      })), _div({
        className: "ui two fields"
      }, _(labelField, {
        text: 'language'
      }, _(dropdown, {
        className: 'selection',
        name: 'lang',
        'default': "please select your language",
        options: {
          cpp: 'cpp',
          pas: 'pas',
          java: 'java'
        }
      }))), _(field, null, _(iconText, {
        className: "primary floated submit",
        text: 'Submit',
        icon: 'rocket'
      })));
    }
  }));
  function importAll$(obj, src){
    for (var key in src) obj[key] = src[key];
    return obj;
  }
}).call(this);
