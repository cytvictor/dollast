// Generated by LiveScript 1.3.1
(function(){
  var _, solApp;
  _ = require('prelude-ls');
  solApp = angular.module('dollast-rnd-app', ["doffirst", "ui.dateTimeInput"]);
  solApp.controller('rnd-list-ctrl', [
    "$scope", "doffirst", "$routeParams", function($scope, doffirst, $routeParams){
      return doffirst.get("/round", $scope);
    }
  ]);
  solApp.controller('rnd-show-ctrl', [
    "$scope", "doffirst", "$routeParams", function($scope, doffirst, $routeParams){
      var rid;
      rid = parseInt($routeParams.rid);
      return doffirst.get("/round/" + rid, $scope);
    }
  ]);
  solApp.controller('rnd-modify-ctrl', [
    "$scope", "doffirst", "$routeParams", function($scope, doffirst, $routeParams){
      var that;
      $scope.pid = 0;
      if (that = $routeParams.rid) {
        doffirst.get("/round/" + that + "/total", $scope, function(it){
          it.rnd._id = that;
          return it.probs = it.rnd.probs;
        });
      } else {
        doffirst.get("/round/next-count", $scope, function(it){
          it.rnd = {
            _id: it._id,
            begTime: new Date(Date.now()),
            endTime: new Date(Date.now())
          };
          it.probs = [];
          return console.log("temp: " + JSON.stringify(it.rnd));
        });
      }
      $scope.submit = function(){
        console.log($scope.rnd);
        $scope.rnd.probs = _.map(function(it){
          return it._id;
        }, $scope.probs);
        return doffirst.put("/round/" + $scope.rnd._id, $scope.rnd);
      };
      $scope.insert = function(){
        var newProb;
        newProb = {};
        return doffirst.get("/problem/" + $scope.pid, newProb, function(it){
          if (it.prob) {
            return $scope.probs.push(it.prob);
          } else {
            throw Error('unimplemented');
          }
        });
      };
      $scope.remove = function(pid){
        return $scope.probs = _.reject(function(it){
          return it._id === pid;
        }, $scope.probs);
      };
      return $scope['delete'] = function(){
        return doffirst['delete']("/round/" + $scope.rnd._id);
      };
    }
  ]);
}).call(this);
